#!/bin/sh

## Call standard ccache script
echo "Updating standard ccache symlinks"
sudo update-ccache-symlinks

## Add clang support
cd /usr/lib/ccache
compilerVersions=`ls /usr/lib/clang`
for name in clang clang++
do
  for version in $compilerVersions
  do
    candidate=$name-$version
    if [ `which $candidate` ]
    then
      echo "Adding $candidate symlink"
      sudo ln -s ../../bin/ccache $candidate
      latestCandidate=$candidate
    fi
  done

  if [ ! `which $name` ]
  then
    echo "Adding $name symlink using $latestCandidate"
    sudo ln -s /usr/bin/$latestCandidate /usr/bin/$name
  fi
  echo "Adding $name symlink"
  sudo ln -s ../../bin/ccache $name
done
